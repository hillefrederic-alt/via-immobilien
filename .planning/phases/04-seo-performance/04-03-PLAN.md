---
phase: 04-seo-performance
plan: 03
type: execute
wave: 3
depends_on: ["04-01", "04-02"]
files_modified:
  - src/layouts/BaseLayout.astro
  - src/components/Hero.astro
autonomous: true

must_haves:
  truths:
    - "Critical fonts are preloaded with crossorigin attribute"
    - "Hero component audited for image optimization (optimized if images exist, or confirmed text-only)"
    - "Font preload links include crossorigin attribute"
  artifacts:
    - path: "src/layouts/BaseLayout.astro"
      provides: "Font preload links"
      contains: "rel=\"preload\""
    - path: "src/components/Hero.astro"
      provides: "Optimized hero section"
      contains: "fetchpriority"
  key_links:
    - from: "src/layouts/BaseLayout.astro"
      to: "/fonts/*.woff2"
      via: "preload links"
      pattern: "preload.*woff2"
---

<objective>
Optimize page performance through font preloading and image loading strategies to achieve Lighthouse 90+ scores.

Purpose: Improve Core Web Vitals (LCP, CLS) by ensuring critical resources load first and non-critical resources load lazily.
Output: Preloaded fonts, optimized image loading attributes.
</objective>

<execution_context>
@/Users/frederichille/.claude/get-shit-done/workflows/execute-plan.md
@/Users/frederichille/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-seo-performance/04-RESEARCH.md

Existing assets:
- Fonts: public/fonts/inter-regular.woff2, inter-semibold.woff2, libre-baskerville-regular.woff2
- Hero component exists at src/components/Hero.astro
- Images likely in public/ or src/assets/

Research findings:
- Font preload MUST have crossorigin attribute (even for self-hosted)
- Only preload 1-2 critical fonts (LCP impact)
- fetchpriority="high" + loading="eager" for above-the-fold images
- loading="lazy" for below-the-fold images
- Astro already uses font-display: swap in global.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add font preloading to BaseLayout</name>
  <files>src/layouts/BaseLayout.astro</files>
  <action>
Add font preload links in the head section, before any stylesheets:

```astro
<!-- Preload critical fonts for LCP optimization -->
<link
  rel="preload"
  href="/fonts/libre-baskerville-regular.woff2"
  as="font"
  type="font/woff2"
  crossorigin
/>
<link
  rel="preload"
  href="/fonts/inter-regular.woff2"
  as="font"
  type="font/woff2"
  crossorigin
/>
```

Preload rationale:
- Libre Baskerville: Used for headings (h1, h2) - affects LCP text
- Inter Regular: Primary body font - most used font
- NOT preloading Inter Semibold: Secondary weight, less critical

IMPORTANT: Include `crossorigin` attribute - required for fonts even when self-hosted.

Place these preload links early in <head>, before CSS imports.
  </action>
  <verify>View page source - check for preload links with crossorigin attribute. DevTools Network tab should show fonts loading with "preload" initiator.</verify>
  <done>Critical fonts (Libre Baskerville and Inter Regular) are preloaded with crossorigin attribute</done>
</task>

<task type="auto">
  <name>Task 2: Audit and optimize image loading attributes</name>
  <files>src/components/Hero.astro</files>
  <action>
Review Hero.astro component for image optimization:

1. If Hero contains an image, ensure it has:
   - loading="eager" (above-the-fold, should not lazy load)
   - fetchpriority="high" (tell browser this is LCP candidate)
   - Explicit width and height attributes (prevents CLS)
   - Descriptive alt text

2. If Hero uses background-image CSS:
   - Consider converting to <img> or <picture> for better optimization
   - Or ensure the CSS is inlined for fast parsing

3. Check for any img tags in other above-the-fold sections:
   - Partner logos, profile photos in hero area
   - These should also have explicit dimensions

Example optimized image:
```astro
<img
  src="/images/hero-home.jpg"
  alt="Denise Semmel, Ihre Immobilienmaklerin"
  width="1200"
  height="800"
  loading="eager"
  fetchpriority="high"
/>
```

If the Hero component doesn't use images (text-only hero), no image optimization changes are needed - the component is already performant.
  </action>
  <verify>
Run this command to check Hero image status:
```bash
grep -E '<img|<Image' src/components/Hero.astro && echo "Images found - verify fetchpriority and loading attributes" || echo "Text-only Hero confirmed - no image optimization needed"
```
If images exist, verify optimization:
```bash
grep -E 'fetchpriority|loading=' src/components/Hero.astro || echo "No optimization attributes found"
```
  </verify>
  <done>Hero component audited: images optimized with fetchpriority="high" if present, or confirmed text-only</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. View page source - font preload links present with crossorigin
2. DevTools Network tab: fonts show "preload" as initiator type
3. No console warnings about "preload found but not used"
4. Hero images (if any) have loading="eager" and fetchpriority="high"
5. Run Lighthouse - check for font/image recommendations
</verification>

<success_criteria>
- Critical fonts preloaded with proper crossorigin attribute
- No "unused preload" warnings in console
- Hero images optimized for above-the-fold loading
- All images have explicit dimensions (no CLS)
- Font loading uses font-display: swap (already in global.css)
</success_criteria>

<output>
After completion, create `.planning/phases/04-seo-performance/04-03-SUMMARY.md`
</output>
